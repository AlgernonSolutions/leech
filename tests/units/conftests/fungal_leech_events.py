import datetime

from dateutil.tz import tzlocal

fungal_leech_events ={'taskToken': 'AAAAKgAAAAIAAAAAAAAAAiB9Xq4DtljrsZiwGnkzBXC0lQokaXXaKx+92HKpKE3WdbO44MVYFtP0q8izSzikFx7Ula0YVtBziGGLGUD35R9SF3xfAqzH61mX4ToyetIpEDGn01KE9QnqOmT+EBfghmhtUHdMKZu0ZYmcNQso+MR0mnn2084es6TcECFvlxsXlYFMXdgJ5EeJ+xJWulg6LjWmFRzw2gs6wqbnTDMKeNThusYJgF13YB8lZLw9/7NORI1CjfQZIe98sBDAdXOtv07rR8qLRKz6hEne7oJNNZd9WJ9H+xQ3gL5p20pxG7n0xhr1zwgggyRIR7dLu6GGfwOLplzUPRdZOr/40s6niZl9OpCO9tU8QJw9W5qauPlhAa1HF2h80VVb7w51+1UGZA==', 'startedEventId': 9, 'workflowExecution': {'workflowId': 'fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39', 'runId': '224jjt7HgyA4yi7npVL4H5aneRCE/62gdQKOE7dGn7Dug='}, 'workflowType': {'name': 'fungal_leech', 'version': '5'}, 'events': [{'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 11, 451000, tzinfo=tzlocal()), 'eventType': 'WorkflowExecutionStarted', 'eventId': 1, 'workflowExecutionStartedEventAttributes': {'input': '{"task_args": {"_alg_class": "TaskArguments", "_alg_module": "toll_booth.alg_obj.aws.gentlemen.tasks", "value": {"_arguments": {"fungus": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/fungus!1548818533.205574.json"}}, "command_fungi": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/command_fungi!1548818533.790767.json"}}, "get_local_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_local_ids!1548798272.508434.json"}}, "get_remote_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_remote_ids!1548798255.14674.json"}}, "put_new_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/put_new_ids!1548800541.315802.json"}}, "link_new_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/link_new_ids!1548800541.31689.json"}}, "unlink_old_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/unlink_old_ids!1548800541.316908.json"}}, "pull_change_types": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/pull_change_types!1548798289.449875.json"}}, "pull_schema_entry": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/pull_schema_entry!1548798297.691525.json"}}, "build_mapping": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/build_mapping!1548798310.310615.json"}}, "work_remote_id": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/work_remote_id4795!1548800542.057197.json"}}, "work_remote_id_change_type": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/work_remote_id_change_type!1548800653.19091.json"}}, "get_local_max_change_type_value": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_local_max_change_type_value!1548800639.580964.json"}}, "work_remote_id_change_action": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/work_remote_id_change_action325!1548800658.911853.json"}}, "get_enrichment_for_change_action": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_enrichment_for_change_action!1548800691.6905.json"}}, "generate_remote_id_change_data": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/generate_remote_id_change_data!1548800701.288855.json"}}, "fungal_leech": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/fungal_leech!1548800948.667823.json"}}}}}, "config": {"_alg_class": "LeechConfig", "_alg_module": "toll_booth.alg_obj.aws.gentlemen.tasks", "value": {"_workflow_configs": {"fungus": {"concurrency": 1, "time_outs": {"decision": "300"}}, "command_fungi": {"concurrency": 1, "labor_task_lists": [{"list_name": "credible", "number_threads": 1, "is_vpc": false}], "time_outs": {"decision": "300"}}, "work_remote_id": {"concurrency": 1, "time_outs": {"decision": "300"}}, "work_remote_id_change_action": {"concurrency": 5, "time_outs": {"decision": "300"}}, "work_remote_id_change_type": {"concurrency": 1, "time_outs": {"decision": "300"}}, "fungal_leech": {"concurrency": 1, "time_outs": {"decision": "300"}}}, "_task_configs": {"get_local_max_change_type_value": {"concurrency": 1}, "pull_change_types": {"concurrency": 1}, "unlink_old_ids": {"concurrency": 1}, "link_new_ids": {"concurrency": 1}, "put_new_ids": {"concurrency": 1}, "get_local_ids": {"concurrency": 1}, "get_remote_ids": {"concurrency": 1, "task_list": "credible"}, "work_remote_id_change_type": {"concurrency": 1, "task_list": "credible"}, "get_enrichment_for_change_action": {"concurrency": 1, "task_list": "credible"}, "pull_schema_entry": {"concurrency": 1}, "build_mapping": {"concurrency": 1}, "transform": {"concurrency": 1}, "assimilate": {"concurrency": 1}, "index": {"concurrency": 1}, "graph": {"concurrency": 1}, "generate_remote_id_change_data": {"concurrency": 1}}}}, "versions": {"_alg_class": "Versions", "_alg_module": "toll_booth.alg_obj.aws.gentlemen.tasks", "value": {"_workflow_versions": {"work_remote_id_change_type": 8, "work_remote_id_change_action": 8, "work_remote_id": 8, "fungus": 8, "fungal_leech": 5, "command_fungi": 8}, "_task_versions": {"work_remote_id_change_type": 7, "unlink_old_ids": 7, "transform": 5, "put_new_ids": 7, "pull_schema_entry": 1, "pull_change_types": 7, "link_new_ids": 7, "index": 3, "graph": 3, "get_remote_ids": 7, "get_local_max_change_type_value": 7, "get_local_ids": 7, "get_enrichment_for_change_action": 7, "generate_remote_id_change_data": 7, "build_mapping": 7, "assimilate": 5}}}}', 'executionStartToCloseTimeout': '86400', 'taskStartToCloseTimeout': '300', 'childPolicy': 'TERMINATE', 'taskList': {'name': 'fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39'}, 'workflowType': {'name': 'fungal_leech', 'version': '5'}, 'parentWorkflowExecution': {'workflowId': 'work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39', 'runId': '22uP8+QPeKeuejC8AM4pyCv9i+GO6WM1f7guXeVxEmuog='}, 'parentInitiatedEventId': 90, 'lambdaRole': 'arn:aws:iam::803040539655:role/swf-lambda'}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 11, 451000, tzinfo=tzlocal()), 'eventType': 'DecisionTaskScheduled', 'eventId': 2, 'decisionTaskScheduledEventAttributes': {'taskList': {'name': 'fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39'}, 'startToCloseTimeout': '300'}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 11, 493000, tzinfo=tzlocal()), 'eventType': 'DecisionTaskStarted', 'eventId': 3, 'decisionTaskStartedEventAttributes': {'scheduledEventId': 2}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 17, 704000, tzinfo=tzlocal()), 'eventType': 'DecisionTaskCompleted', 'eventId': 4, 'decisionTaskCompletedEventAttributes': {'scheduledEventId': 2, 'startedEventId': 3}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 17, 704000, tzinfo=tzlocal()), 'eventType': 'LambdaFunctionScheduled', 'eventId': 5, 'lambdaFunctionScheduledEventAttributes': {'id': 'transform-fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39', 'name': 'leech-lambda-labor', 'input': '{"task_name": "transform", "task_args": {"_alg_class": "TaskArguments", "_alg_module": "toll_booth.alg_obj.aws.gentlemen.tasks", "value": {"_arguments": {"fungus": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/fungus!1548818533.205574.json"}}, "command_fungi": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/command_fungi!1548818533.790767.json"}}, "get_local_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_local_ids!1548798272.508434.json"}}, "get_remote_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_remote_ids!1548798255.14674.json"}}, "put_new_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/put_new_ids!1548800541.315802.json"}}, "link_new_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/link_new_ids!1548800541.31689.json"}}, "unlink_old_ids": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/unlink_old_ids!1548800541.316908.json"}}, "pull_change_types": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/pull_change_types!1548798289.449875.json"}}, "pull_schema_entry": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/pull_schema_entry!1548798297.691525.json"}}, "build_mapping": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/build_mapping!1548798310.310615.json"}}, "work_remote_id": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/work_remote_id4795!1548800542.057197.json"}}, "work_remote_id_change_type": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/work_remote_id_change_type!1548800653.19091.json"}}, "get_local_max_change_type_value": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_local_max_change_type_value!1548800639.580964.json"}}, "work_remote_id_change_action": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/work_remote_id_change_action325!1548800658.911853.json"}}, "get_enrichment_for_change_action": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/get_enrichment_for_change_action!1548800691.6905.json"}}, "generate_remote_id_change_data": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/generate_remote_id_change_data!1548800701.288855.json"}}, "fungal_leech": {"_alg_class": "StoredData", "_alg_module": "toll_booth.alg_obj.aws.snakes.snakes", "value": {"pointer": "the-leech#cache/fungal_leech!1548800948.667823.json"}}}}}, "flow_id": "fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39", "run_id": "224jjt7HgyA4yi7npVL4H5aneRCE/62gdQKOE7dGn7Dug=", "task_id": "transform-fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39", "register_results": false}', 'decisionTaskCompletedEventId': 4}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 17, 756000, tzinfo=tzlocal()), 'eventType': 'LambdaFunctionStarted', 'eventId': 6, 'lambdaFunctionStartedEventAttributes': {'scheduledEventId': 5}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 20, 732000, tzinfo=tzlocal()), 'eventType': 'LambdaFunctionCompleted', 'eventId': 7, 'lambdaFunctionCompletedEventAttributes': {'scheduledEventId': 5, 'startedEventId': 6, 'result': '"{\\"_alg_class\\": \\"StoredData\\", \\"_alg_module\\": \\"toll_booth.alg_obj.aws.snakes.snakes\\", \\"value\\": {\\"pointer\\": \\"the-leech#cache/transform!1548800960.368179.json\\"}}"'}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 20, 732000, tzinfo=tzlocal()), 'eventType': 'DecisionTaskScheduled', 'eventId': 8, 'decisionTaskScheduledEventAttributes': {'taskList': {'name': 'fungal_leech-work_action-PRINT CLIENT MEDICATIONS-work_type-Print-work_id-4795-f-39'}, 'startToCloseTimeout': '300'}}, {'eventTimestamp': datetime.datetime(2019, 1, 29, 22, 29, 20, 759000, tzinfo=tzlocal()), 'eventType': 'DecisionTaskStarted', 'eventId': 9, 'decisionTaskStartedEventAttributes': {'scheduledEventId': 8}}], 'previousStartedEventId': 3, 'ResponseMetadata': {'RequestId': '679e7011-c1dc-4402-8c8a-06778834fcd5', 'HTTPStatusCode': 200, 'HTTPHeaders': {'x-amzn-requestid': '679e7011-c1dc-4402-8c8a-06778834fcd5', 'date': 'Tue, 29 Jan 2019 22:29:20 GMT', 'content-type': 'application/x-amz-json-1.0', 'content-length': '13075'}, 'RetryAttempts': 0}}