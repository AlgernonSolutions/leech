AWSTemplateFormatVersion: 2010-09-09
Transform:
  - 'AWS::Serverless-2016-10-31'
  - 'AWS::CodeStar'
Parameters:
  ProjectId:
    Type: String
    Description: CodeStar projectId used to associate new resources to team members
Resources:
  CredibleTasks:
    Type: AWS::SQS::Queue
    Properties:
      RedrivePolicy:
        deadLetterTargetArn:
          !GetAtt DeadLetter.Arn
        maxReceiveCount: 15
      KmsMasterKeyId: alias/aws/sqs
  DeadLetter:
    Type: AWS::SQS::Queue
    Properties:
      KmsMasterKeyId: alias/aws/sqs
      MessageRetentionPeriod: 1209600
  FifoDeadLetter:
    Type: AWS::SQS::Queue
    Properties:
      KmsMasterKeyId: alias/aws/sqs
      MessageRetentionPeriod: 1209600
Outputs:
  CredibleTasksQueueUrl:
    Description: the url of the generated queue for Credible tasks
    Value: !Ref CredibleTasks
  CredibleTasksQueueArn:
    Description: the ARN of the generated queue for Credible tasks
    Value: !GetAtt CredibleTasks.Arn
  DeadLetterQueueUrl:
    Description: the url of the generated dead letter queue
    Value: !Ref DeadLetter
  DeadLetterQueueArn:
    Description: the ARN of the generated dead letter queue
    Value: !GetAtt DeadLetter.Arn
  DeadLetterQueueName:
    Description: the name of the generated dead letter queue
    Value: !GetAtt DeadLetter.QueueName
  FifoDeadLetterQueueUrl:
    Description: the url of the generated FIFO dead letter queue
    Value: !Ref DeadLetter
  FifoDeadLetterQueueArn:
    Description: the ARN of the generated FIFO dead letter queue
    Value: !GetAtt DeadLetter.Arn
  FifoDeadLetterQueueName:
    Description: the name of the generated FIFO dead letter queue
    Value: !GetAtt DeadLetter.QueueName